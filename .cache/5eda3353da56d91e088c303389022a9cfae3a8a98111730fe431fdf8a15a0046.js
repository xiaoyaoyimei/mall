{"source":"webpackJsonp([22],{\"1wt9\":function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var s={data:function(){return{imgmust:\"N\",reasonList:[],defaultList:[],imgName:\"\",visible:!1,uploadList:[],uploadUrl:this.$axios.defaults.baseURL+\"/upload/upload?path=account\",addForm:{orderNo:\"\",refundCauseId:\"\",refundImgs:[],remarks:\"\"},ruleValidate:{refundCauseId:[{required:!0,message:\"请选择退款退货原因\",trigger:\"change\"}]}}},methods:{handleView:function(e){this.imgName=e,this.visible=!0},handleRemove:function(e){var t=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(t.indexOf(e),1)},handleSuccess:function(e,t){\"200\"==e.code&&(t.url=e.msg,t.name=e.msg),console.log(this.uploadList)},handleFormatError:function(e){this.$Notice.warning({title:\"文件格式不正确\",desc:\"文件格式不正确,请选择 jpg 或 png.\"})},handleMaxSize:function(e){this.$Notice.warning({title:\"文件大小超过限制\",desc:\"上传文件 太大，不超过2M.\"})},handleBeforeUpload:function(){var e=this.uploadList.length<9;return e||this.$Notice.warning({title:\"最多可上传9张图片.\"}),e},img_must:function(e){for(var t=0;t<this.reasonList.length;t++)this.reasonList[t].causeId==e&&(this.imgmust=this.reasonList[t].isImg)},getStatusEnum:function(){var t=this;this.$axios({method:\"get\",url:\"/refund/getRefundCauseList\"}).then(function(e){t.reasonList=e})},getParams:function(){this.addForm.orderNo=this.$route.query.rforder},handleSubmit:function(e){var a=this;this.$refs[e].validate(function(e){if(e)if(\"Y\"!=a.imgmust||0!=a.uploadList.length){a.uploadList.forEach(function(e,t){a.addForm.refundImgs[t]=e.url});var t=a;a.$axios({method:\"post\",url:\"/refund/creare\",data:{orderNo:t.addForm.orderNo,refundCauseId:t.addForm.refundCauseId,refundImgs:t.addForm.refundImgs,remarks:t.addForm.remarks}}).then(function(e){\"200\"==e.code?(a.$Message.info(e.object),a.$router.go(-1)):a.$Message.error(e.msg)})}else a.$Message.warning(\"请上传退货凭证\")})}},mounted:function(){this.getStatusEnum(),this.getParams(),this.uploadList=this.$refs.upload.fileList}},r={render:function(){var a=this,e=a.$createElement,s=a._self._c||e;return s(\"div\",{staticClass:\"order\"},[s(\"div\",{staticClass:\"m_header_bar\"},[s(\"router-link\",{staticClass:\"m_header_bar_back\",attrs:{to:\"/user/orderlist\"}},[s(\"Icon\",{attrs:{type:\"ios-arrow-back\"}})],1),a._v(\" \"),s(\"span\",{staticClass:\"m_header_bar_title\"},[a._v(\"申请退货退款\")]),a._v(\" \"),s(\"span\",{staticClass:\"m_header_bar_menu\"})],1),a._v(\" \"),s(\"Form\",{ref:\"addForm\",staticStyle:{background:\"#fff\"},attrs:{model:a.addForm,rules:a.ruleValidate,\"label-width\":100}},[s(\"FormItem\",{attrs:{label:\"订单号\",prop:\"orderNo\"}},[s(\"span\",[a._v(a._s(a.addForm.orderNo))])]),a._v(\" \"),s(\"FormItem\",{attrs:{label:\"退款退货原因\",prop:\"refundCauseId\"}},[s(\"Select\",{on:{\"on-change\":a.img_must},model:{value:a.addForm.refundCauseId,callback:function(e){a.$set(a.addForm,\"refundCauseId\",e)},expression:\"addForm.refundCauseId\"}},a._l(a.reasonList,function(e){return s(\"Option\",{key:e.causeId,attrs:{value:e.causeId}},[a._v(\" \"+a._s(e.content))])}))],1),a._v(\" \"),s(\"FormItem\",{attrs:{label:\"上传退货凭证\",prop:\"refundImgs\"}},[a._l(a.uploadList,function(t){return s(\"div\",{staticClass:\"demo-upload-list\"},[\"finished\"===t.status?[s(\"img\",{attrs:{src:a._f(\"imgfilter\")(t.url)}}),a._v(\" \"),s(\"div\",{staticClass:\"demo-upload-list-cover\"},[s(\"Icon\",{attrs:{type:\"ios-eye-outline\"},nativeOn:{click:function(e){a.handleView(t.name)}}}),a._v(\" \"),s(\"Icon\",{attrs:{type:\"ios-trash-outline\"},nativeOn:{click:function(e){a.handleRemove(t)}}})],1)]:[t.showProgress?s(\"Progress\",{attrs:{percent:t.percentage,\"hide-info\":\"\"}}):a._e()]],2)}),a._v(\" \"),s(\"Upload\",{ref:\"upload\",staticStyle:{display:\"inline-block\",width:\"78px\"},attrs:{\"show-upload-list\":!1,\"default-file-list\":a.defaultList,\"on-success\":a.handleSuccess,format:[\"jpg\",\"jpeg\",\"png\"],\"max-size\":2048,\"on-format-error\":a.handleFormatError,\"on-exceeded-size\":a.handleMaxSize,\"before-upload\":a.handleBeforeUpload,multiple:\"\",type:\"drag\",action:a.uploadUrl}},[s(\"div\",{staticStyle:{width:\"78px\",height:\"78px\",\"line-height\":\"78px\"}},[s(\"Icon\",{attrs:{type:\"ios-camera\",size:\"20\"}})],1)]),a._v(\" \"),s(\"Modal\",{staticClass:\"imglarger\",attrs:{title:\"查看大图\"},model:{value:a.visible,callback:function(e){a.visible=e},expression:\"visible\"}},[a.visible?s(\"img\",{staticStyle:{width:\"100%\"},attrs:{src:a._f(\"imgfilter\")(a.imgName)}}):a._e()])],2),a._v(\" \"),s(\"FormItem\",{attrs:{label:\"退款退货理由\",prop:\"refundImgs\"}},[s(\"Input\",{attrs:{type:\"textarea\",autosize:{minRows:2,maxRows:5},placeholder:\"退款退货理由\"},model:{value:a.addForm.remarks,callback:function(e){a.$set(a.addForm,\"remarks\",e)},expression:\"addForm.remarks\"}})],1),a._v(\" \"),s(\"FormItem\",[s(\"Button\",{attrs:{type:\"primary\"},on:{click:function(e){a.handleSubmit(\"addForm\")}}},[a._v(\"提交\")])],1)],1)],1)},staticRenderFns:[]};var i=a(\"VU/8\")(s,r,!1,function(e){a(\"wkXK\")},\"data-v-cf810c2e\",null);t.default=i.exports},wkXK:function(e,t){}});"}