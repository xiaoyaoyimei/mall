{"source":"webpackJsonp([34],{\"/w+U\":function(t,s){},Z34o:function(t,s,o){\"use strict\";Object.defineProperty(s,\"__esModule\",{value:!0});var e=o(\"woOf\"),a=o.n(e),i=o(\"mvHQ\"),r=o.n(i),c={data:function(){return{orderfail:!1,xscoupon:!1,couponCode:\"\",imageSrc:this.global_.imgurl,indeterminate:!0,checkAll:!1,checkAllGroup:[],totalPrice:0,cartList:[],editface:!0,zslcount:0,temp:[],addressList:{},youdizhi:!1,tempcart:[],productItemIds:[],couponshow:!0,couponmsg:{availableSku:\"\",availableCatalog:\"\",modeValue:\"\",couponMode:\"\"}}},methods:{jisuan:function(t){var o=this;if(null==t)this.cartList.forEach(function(t,s){o.totalPrice+=t.salePrice*t.quantity});else{var e=t;\"\"==e.availableSku&&\"\"==e.availableCatalog?(o.totalPrice=0,\"rate\"==e.couponMode?this.cartList.forEach(function(t,s){\"\"!=t.promotionTitle&&null!=t.promotionTitle&&null!=t.promotionTitle?o.totalPrice+=t.salePrice*t.quantity:o.totalPrice+=t.salePrice*(1-e.modeValue)*t.quantity}):this.cartList.forEach(function(t,s){\"\"!=t.promotionTitle&&null!=t.promotionTitle&&null!=t.promotionTitle?o.totalPrice+=t.salePrice*t.quantity:o.totalPrice+=(t.salePrice-e.modeValue)*t.quantity})):\"\"!=e.availableSku?(o.totalPrice=0,\"rate\"==e.couponMode?this.cartList.forEach(function(t,s){t.id==e.availableCatalog?o.totalPrice+=t.salePrice*(1-e.modeValue)*t.quantity:o.totalPrice+=t.salePrice*t.quantity}):this.cartList.forEach(function(t,s){t.id==e.availableCatalog?o.totalPrice+=(t.salePrice-e.modeValue)*t.quantity:o.totalPrice+=t.salePrice*t.quantity})):(o.totalPrice=0,\"rate\"==e.couponMode?this.cartList.forEach(function(t,s){t.productType==e.availableSku?o.totalPrice+=t.salePrice*(1-e.modeValue)*t.quantity:o.totalPrice+=t.salePrice*t.quantity}):this.cartList.forEach(function(t,s){t.productType==e.availableSku?o.totalPrice+=(t.salePrice-e.modeValue)*t.quantity:o.totalPrice+=t.salePrice*t.quantity}))}},getDD:function(){var t=this.$route.params.address;null!=t&&(this.addressList=t,this.youdizhi=!0)},getCartList:function(){this.cartList=JSON.parse(sessionStorage.getItem(\"cart\"));var o=this;o.productItemIds=[];var e=0;this.cartList.forEach(function(t,s){\"\"!=t.promotionTitle&&null!=t.promotionTitle&&(e+=1),o.productItemIds.push(t.id)}),this.cartList.length==e?this.couponshow=!1:this.couponshow=!0},addAdd:function(){localStorage.setItem(\"fromc\",\"dingdan\"),this.$router.push({name:\"/user/address\"})},getAddress:function(){var s=this;this.$axios({method:\"post\",url:\"/address\"}).then(function(t){0<t.length&&t.map(function(t){\"Y\"==t.isDefault&&\"{}\"==r()(s.addressList)&&(s.addressList=t,s.youdizhi=!0)})})},confirm:function(){var s=this;if(null!=this.addressList.id){var t={addressId:this.addressList.id,productItemIds:this.productItemIds,couponCode:this.couponCode};this.$axios({method:\"post\",url:\"/order/shopping/confirm\",data:t}).then(function(t){\"200\"==t.code?s.$router.push({name:\"/cartthree\",query:{orderNo:t.msg}}):s.$Modal.error({title:\"加入购物车失败\",content:t.msg})})}else this.$Modal.error({content:\"收货地址不能为空\"})},usecoupon:function(){var s=this;if(this.xscoupon=!1,\"\"!=this.couponCode){var t={addressId:this.addressList.id,productItemIds:this.productItemIds,couponCode:this.couponCode};this.$axios({method:\"post\",url:\"/promotion/coupon\",data:t}).then(function(t){\"200\"==t.code?(s.xscoupon=!0,s.couponmsg=a()({},t.object),s.jisuan(s.couponmsg)):(s.xscoupon=!1,s.$Message.error(t.object))})}else this.$Message.error(\"优惠码不能为空\")},couponprice:function(t){var s=this.couponmsg;return\"rate\"==s.couponMode?t*(1-s.modeValue):t-s.modeValue}},mounted:function(){this.getAddress(),this.getCartList(),this.getDD(),this.jisuan()}},n={render:function(){var o=this,t=o.$createElement,e=o._self._c||t;return e(\"div\",{staticClass:\"paymoney\"},[e(\"div\",{staticClass:\"m_header_bar\"},[e(\"router-link\",{staticClass:\"m_header_bar_back\",attrs:{to:\"/cart\"}},[e(\"Icon\",{attrs:{type:\"ios-arrow-back\"}})],1),o._v(\" \"),e(\"span\",{staticClass:\"m_header_bar_title\"},[o._v(\"填写订单\")]),o._v(\" \"),e(\"span\",{staticClass:\"m_header_bar_menu\"})],1),o._v(\" \"),e(\"div\",{staticClass:\"chooseAddress\"},[o.youdizhi?e(\"ul\",{staticClass:\"address\"},[e(\"li\",[e(\"p\",[e(\"strong\",[o._v(o._s(o.addressList.person)+\" \"),e(\"label\",[o._v(o._s(o.addressList.phone))])]),o._v(\" \"),e(\"span\",[o._v(o._s(o.addressList.receiveProvince)+o._s(o.addressList.receiveCity)+o._s(o.addressList.receiveDistrict)+o._s(o.addressList.address))])]),o._v(\" \"),e(\"Icon\",{attrs:{type:\"chevron-right\"},nativeOn:{click:function(t){return o.addAdd(t)}}})],1)]):e(\"div\",{staticClass:\"zeroAddress\"},[e(\"div\",{on:{click:o.addAdd}},[o._v(\"\\n                \\t\\t请选择收货地址\\n                \\t\"),e(\"Icon\",{staticClass:\"float float1\",attrs:{type:\"ios-arrow-right\"}})],1)])]),o._v(\" \"),e(\"div\",{staticClass:\"carttwo\"},o._l(o.cartList,function(t,s){return e(\"Row\",{key:s,staticClass:\"cartCol\",attrs:{span:\"24\"}},[e(\"i-col\",{attrs:{span:\"6\"}},[e(\"img\",{staticClass:\"cartImg\",attrs:{src:o.imageSrc+t.image}})]),o._v(\" \"),e(\"i-col\",{attrs:{span:\"18\"}},[e(\"p\",{staticClass:\"cart_black\"},[o._v(o._s(t.productName))]),o._v(\" \"),e(\"p\",{staticClass:\"cart_attr\"},[o._v(\"\\n\\t\\t\\t\\t\\t\\t\\t\\t\"+o._s(t.productAttr)+\" \\t\\t\\n\\t\\t\\t\\t\\t\\t\\t\\t\")]),o._v(\" \"),e(\"div\",{staticClass:\"cart_gray\"},[e(\"p\",[null!=t.promotionTitle?e(\"label\",{staticClass:\"promotion\"},[o._v(o._s(t.promotionTitle))]):o._e(),o._v(\" \"),e(\"span\",{staticClass:\"color-dx\"},[o._v(\"￥\"+o._s(o._f(\"pricefilter\")(t.salePrice))+\"x\"+o._s(t.quantity))]),o._v(\" \"),null==t.promotionTitle&&o.xscoupon?e(\"span\",{staticClass:\"color-dx\"},[o._v(\"\\n\\t\\t\\t\\t\\t       \\t \\t￥\"+o._s(o._f(\"pricefilter\")(o.couponprice(t.salePrice)))+\"x\"+o._s(t.quantity)+\"\\n\\t\\t\\t\\t\\t       \\t \")]):o._e()])])])],1)})),o._v(\" \"),e(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:o.couponshow,expression:\"couponshow\"}],staticClass:\"yhm\"},[e(\"span\",[o._v(\"优惠券\")]),e(\"input\",{directives:[{name:\"model\",rawName:\"v-model.trim\",value:o.couponCode,expression:\"couponCode\",modifiers:{trim:!0}}],attrs:{type:\"text\",placeholder:\"优惠券\"},domProps:{value:o.couponCode},on:{input:function(t){t.target.composing||(o.couponCode=t.target.value.trim())},blur:function(t){o.$forceUpdate()}}}),o._v(\" \"),e(\"span\",{staticClass:\"use\",on:{click:o.usecoupon}},[o._v(\"使用\")])]),o._v(\" \"),e(\"div\",{staticClass:\"cartfoot\"},[e(\"strong\",[e(\"span\",{staticClass:\"color-dx\"},[o._v(\"￥\"+o._s(o._f(\"pricefilter\")(o.totalPrice)))])]),o._v(\" \"),e(\"button\",{attrs:{type:\"button\"},on:{click:o.confirm}},[o._v(\" \\n\\t\\t\\t\\t提交订单\\n\\t\\t\\t\")])])])},staticRenderFns:[]};var l=o(\"VU/8\")(c,n,!1,function(t){o(\"/w+U\")},\"data-v-10339bf0\",null);s.default=l.exports}});"}